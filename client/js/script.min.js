$(document).ready(function(){var e;function o(e){document.getElementById("memberName").innerHTML="<b>"+e+"</b>"}function t(e){document.getElementById("artsDeck").innerHTML=e.map(e=>`<div class="col-sm-12 col-md-6 col-lg-4 my-xs-1 my-sm-1 my-md-3 my-lg-3">\n      <div class="card card-border rounded-0 mb-4">\n\n      <img src="${e.image}" alt="Avatar" class="card-img-top radius">\n\n      <div class="card-body artcard-body mx-1 my-1">\n      <div class="artcard-columnwrap">\n      <h4 class="card-title artcard-title mb-3">${e.title}</h4>\n      <h5 class="card-title artcard-price">&dollar;${e.price}</h5>\n      </div>\n      <p class="card-title"><b>${e.authorInfo.username}, ${e.authorInfo.location}</b></p>\n      <p class="mb-3 text-truncate">${e.description}</p>\n      <a href="${e.authorInfo.website}" class="card-link artcard-link">Artist Website</a>\n      <div class="artcard-columnwrap mt-4">\n      <p class="card-title h5-cyan">${e.category}</p>\n      <div class="button viewMoreButton btn-font" id="${e._id}">View</div>\n      </div>\n      </div>\n\n      </div>\n      </div>`).join(" ");let o=document.getElementsByClassName("viewMoreButton");for(let e=0;e<o.length;e++)o[e].addEventListener("click",n)}function n(o){let t=o.target.id;$.ajax({url:`${e}/portfolioWithAuthor/${t}`,type:"GET",dataType:"json",success:function(e){!function(e){document.getElementById("viewMorePage-artInfo").innerHTML=`\n    <div>\n    <h5 class="h3">${e.title}</h5>\n    <div class="viewMore-photoBackground">\n    <img src="${e.image}" class="viewMore-mainPhoto" alt="${e.title} photo">\n    </div>\n    <div class="flexContainer-row mt-3 mb-3">\n    <h5 class="h4">${e.authorInfo.username}</h5>\n    <h5 class="card-title h4 artcard-price">&dollar;${e.price}</h5>\n    </div>\n    <p>${e.description}</p>\n    <strong class="mb-5">Location: ${e.authorInfo.location}</strong>\n    <br/>\n    <a href="${e.authorInfo.website}" class="artcard-link">${e.authorInfo.website}</a>\n    <div class="artcard-columnwrap mt-5 viewMore-endBoarder">\n    <p class="card-title h5-cyan">${e.category}</p>\n    <div class="bg-info text-white radius py-2 px-3 btn-font" id="${e._id}">Buy Now</div>\n    </div>\n    <button id="backToLanding" type="button" class="btn btn-dark mt-3 mb-5 btn-font radius">Back</button>\n    </div>\n    `,$("html, body").animate({scrollTop:0},"fast"),document.getElementById("backToLanding").addEventListener("click",function(){$("#viewMorePage").hide(),$("#landingPage").show(),sessionStorage.removeItem("currentPortfolio")})}(e[0]),sessionStorage.setItem("currentPortfolio",e[0]._id),$("#viewMorePage").show(),$("#projectPage").hide(),$("#landingPage").hide(),0!==e[0].comments.length?function(e){let o=sessionStorage.getItem("usersName");for(let t=0;t<e.length;t++)o&&e[t].postByUsername===o?document.getElementById("viewMorePage-comments").innerHTML+=`\n        <div class="comment-container comment-right mb-3">\n        <div class="comment-info">\n        <strong class="mr-1">You</strong>\n        <p>on ${i(e[t].posted)}</p>\n        </div>\n        <p><b>${e[t].text}</b></p>\n        </div>\n        `:e[t].postByUsername!==o&&(document.getElementById("viewMorePage-comments").innerHTML+=`\n        <div class="comment-container comment-left mb-3">\n        <div class="comment-info">\n        <strong class="mr-1">${e[t].postByUsername}</strong>\n        <p>on ${i(e[t].posted)}</p>\n        </div>\n        <p>${e[t].text}</p>\n        </div>\n        `)}(e[0].comments):document.getElementById("viewMorePage-comments").innerHTML='\n          <div class="text-center">There has not been any question about this artwork</div>\n          '},error:function(e){console.log("Error: "+e)}})}function i(e){let o=new Date(e);return`${o.getDate()}/${o.getMonth()}/${o.getFullYear()} at ${o.getHours()}:${(o.getMinutes()<10?"0":"")+o.getMinutes()}`}console.log(sessionStorage),$.ajax({url:"config.json",type:"GET",dataType:"json",success:function(o){e=o.SERVER_URL+":"+o.SERVER_PORT,console.log(e),$.ajax({url:`${e}/portfoliosAndAuthors`,type:"GET",dataType:"json",success:function(e){t(e)},error:function(e){console.log("Error: "+e)}})},error:function(){}}),sessionStorage.usersName?($("#logoutBtn").show(),$("#myPortfolioBtn").show(),$("#loginBtn").hide(),$("#signUpBtn").hide(),o(sessionStorage.usersName),$("#landingPage").show(),$("#viewMorePage").hide(),$("#loginPage").hide(),$("#signUpPage").hide(),$("#projectPage").hide(),$("#uploadPortfolioPage").hide(),$("#updatePortfolioPage").hide(),$("#deletePortfolioPage").hide()):($("#logoutBtn").hide(),$("#myPortfolioBtn").hide(),$("#loginBtn").show(),$("#signUpBtn").show(),$("#landingPage").show(),$("#viewMorePage").hide(),$("#loginPage").hide(),$("#signUpPage").hide(),$("#projectPage").hide(),$("#uploadPortfolioPage").hide(),$("#updatePortfolioPage").hide(),$("#deletePortfolioPage").hide()),$("#homeBtn").click(function(){$("#landingPage").show(),$("#viewMorePage").hide(),$("#loginPage").hide(),$("#signUpPage").hide(),$("#projectPage").hide(),$("#uploadPortfolioPage").hide(),$("#updatePortfolioPage").hide(),$("#deletePortfolioPage").hide()}),$("#loginBtn").click(function(){$("#loginPage").show(),$("#landingPage").hide(),$("#viewMorePage").hide(),$("#signUpPage").hide(),$("#projectPage").hide(),$("#uploadPortfolioPage").hide(),$("#updatePortfolioPage").hide(),$("#deletePortfolioPage").hide()}),$("#signUpBtn").click(function(){$("#signUpPage").show(),$("#projectPage").hide(),$("#loginPage").hide(),$("#landingPage").hide(),$("#viewMorePage").hide(),$("#uploadPortfolioPage").hide(),$("#updatePortfolioPage").hide(),$("#deletePortfolioPage").hide()}),$("#myPortfolioBtn").click(function(){!function(){let o=sessionStorage.getItem("memberId");if(!o)return;$.ajax({url:`${e}/myPortfolios/${o}`,type:"GET",success:function(e){console.log(e),"No portfolio by this user found"!==e?function(e){document.getElementById("myProjectCards").innerHTML=e.map(e=>`\n    <div class="card portfolioCard border-bottom">\n    <div style="background-image:url(${e.image})" class="portfolioPage-image mb-3"></div>\n    <h5 class="card-text mb-3">${e.title}</h5>\n    <div class="portfolioPage-buttonsWrapper">\n    <div class="portfolioPage-buttonGroup">\n    <div class="button viewMoreButton btn-font" id="${e._id}">View</div>\n    <div class="button-black editButton btn-font" id="${e._id}">Edit</div>\n    </div>\n    <div class="button-red deleteButton btn-font" id="${e._id}">Delete</div>\n    </div>\n    </div>\n    `).join(" ");let o=document.getElementsByClassName("viewMoreButton");for(let e=0;e<o.length;e++)o[e].addEventListener("click",n)}(e):document.getElementById("myProjectCards").innerHTML='\n        <div class="noPortfolio text-center">You have not upload any project yet!</div>\n        '},error:function(e){console.log(e)}})}(),function(){let o=sessionStorage.getItem("memberId");if(!o)return;$.ajax({url:`${e}/myAccountInfo/${o}`,type:"GET",dataType:"json",success:function(e){var o;console.log(e),o=e,document.getElementById("memberAccount").innerHTML=`\n  <div class="flexContainer-flexStart mb-1">\n    <strong class="userInfoField">Username:</strong>\n    <div>${o.username}</div>\n  </div>\n  <div class="flexContainer-flexStart mb-1">\n    <strong class="userInfoField">Email:</strong>\n    <div>${o.email}</div>\n  </div>\n  <div class="flexContainer-flexStart mb-1">\n    <strong class="userInfoField">About:</strong>\n    <div>${o.about}</div>\n  </div>\n  <div class="flexContainer-flexStart mb-1">\n    <strong class="userInfoField">Location:</strong>\n    <div>${o.location}</div>\n  </div>\n  <div class="flexContainer-flexStart mb-1">\n    <strong class="userInfoField">Website:</strong>\n    <a>${o.website}</a>\n  </div>\n  `},error:function(e){console.log(e)}})}(),$("#projectPage").show(),$("#signUpPage").hide(),$("#loginPage").hide(),$("#landingPage").hide(),$("#viewMorePage").hide(),$("#uploadPortfolioPage").hide(),$("#updatePortfolioPage").hide(),$("#deletePortfolioPage").hide()}),$("#addPortfolio").click(function(){$("#uploadPortfolioPage").show(),$("#projectPage").hide(),$("#signUpPage").hide(),$("#loginPage").hide(),$("#landingPage").hide(),$("#viewMorePage").hide(),$("#updatePortfolioPage").hide(),$("#deletePortfolioPage").hide()}),$(".back-portfolio").click(function(){$("#projectPage").show(),$("#uploadPortfolioPage").hide(),$("#signUpPage").hide(),$("#loginPage").hide(),$("#landingPage").hide(),$("#viewMorePage").hide(),$("#updatePortfolioPage").hide(),$("#deletePortfolioPage").hide()}),$("#updateProject").click(function(){$("#uploadPortfolioPage").hide(),$("#projectPage").hide(),$("#signUpPage").hide(),$("#loginPage").hide(),$("#landingPage").hide(),$("#viewMorePage").hide(),$("#updatePortfolioPage").show(),$("#deletePortfolioPage").hide()}),$("#deleteProject").click(function(){$("#uploadPortfolioPage").hide(),$("#projectPage").hide(),$("#signUpPage").hide(),$("#loginPage").hide(),$("#landingPage").hide(),$("#viewMorePage").hide(),$("#updatePortfolioPage").hide(),$("#deletePortfolioPage").show()}),$("#logoutBtn").click(function(){sessionStorage.clear(),$("#landingPage").show(),$("#loginPage").hide(),$("#signUpPage").hide(),$("#projectPage").hide(),$("#uploadPortfolioPage").hide(),$("#updatePortfolio").hide(),location.reload("#loginForm")}),$("#viewMembersBtn").click(function(){$.ajax({url:`${e}/allMembers`,type:"GET",dataType:"json",success:function(e){console.log(e),$("#membersCards").empty(),document.getElementById("membersCards").innerHTML+='<h2 class="pt-5 pb-4">All Members</h2>';for(let o=0;o<e.length;o++)document.getElementById("membersCards").innerHTML+=`<div class="col mt-3">\n        <h4> ${e[o].username}</h4>\n        </div>`},error:function(){}})}),$("#registerForm").submit(function(){event.preventDefault();let o=$("#registerUsername").val(),t=$("#registerEmail").val(),n=$("#registerPassword").val();$.ajax({url:`${e}/registerMember`,type:"POST",data:{username:o,email:t,password:n},success:function(e){"Username already taken. Please try another one"!==e?(alert("Please login to add artwork and buy art"),$("#loginBtn").show(),$("#registerBtn").hide()):(alert("Username already taken. Please try another one"),$("#registerUsername").val(""),$("#registerEmail").val(""),$("#registerPassword").val(""))},error:function(){}})}),$("#loginSubmitBtn").click(function(){event.preventDefault();let t=$("#inputUsernameLogin").val(),n=$("#inputPasswordLogin").val();$.ajax({url:`${e}/loginMember`,type:"POST",data:{username:t,password:n},success:function(e){"Please fill in all input fields"===e?alert("Please fill in all input fields"):"Member not found. Please register"===e?alert("Register please"):"Not Authorized"===e?alert("Incorrect Password"):(sessionStorage.setItem("memberId",e._id),sessionStorage.setItem("usersName",e.username),sessionStorage.setItem("userEmail",e.email),o(t),$("#logoutBtn").show(),$("#myPortfolioBtn").show(),$("#loginBtn").hide(),$("#signUpBtn").hide(),$("#landingPage").show(),$("#loginPage").hide(),$("html, body").animate({scrollTop:0},"fast"))},error:function(){}})}),$("#addPortfolioForm").submit(function(){if(event.preventDefault(),!sessionStorage.memberId)return void alert("401, permission denied");let o=$("#addPortfolioTitle").val(),t=$("#addPortfolioDescription").val(),n=$("#addPortfolioImage").val(),i=$("#addPortfolioCategory").val(),a=$("#addPortfolioPrice").val(),r=$("#addPortfolioMemberId").val();""==o||""==t||""==n||""==i||""==a||""==r?alert("Please enter all details"):$.ajax({url:`${e}/addPortfolio`,type:"POST",data:{title:o,description:t,image:n,category:i,price:a,memberId:sessionStorage.getItem("memberId")},success:function(e){"Title taken already, please try another one"!==e?alert("Added the portfolio"):alert("Title taken already, please try another one"),$("#addPortfolioTitle").val(),$("#addPortfolioDescription").val(),$("#addPortfolioImage").val(),$("#addPortfolioCategory").val(),$("#addPortfolioPrice").val(),$("#addPortfolioMemberId").val(),$("#addPortfolioForm").trigger("reset"),$("#uploadPortfolioPage").hide(),$("#landingPage").show(),$("html, body").animate({scrollTop:0},"fast")},error:function(){}})}),document.getElementById("filterButton").addEventListener("click",function(){let o=JSON.parse($("#filterDropdown-byPrice").val()).min,n=JSON.parse($("#filterDropdown-byPrice").val()).max,i=$("#filterDropdown-byCategory").val();$.ajax({url:`${e}/filterPortfolios/${o}/${n}/${i}`,type:"GET",success:function(e){console.log(e),"Sorry, there is no artwork that matches your search!"===e?document.getElementById("artsDeck").innerHTML='\n          <div class="noResultText-wrapper">\n          <h3 class="noResultText">Sorry, there is no artwork that matches your search!</h3>\n          </div>\n          ':t(e)},error:function(e){console.log("Error: "+e)}})}),document.getElementById("viewMorePage-postCommentButton").addEventListener("click",function(){let o=$("textarea#viewMorePage-postComment").val(),t=Date.now(),n=sessionStorage.getItem("currentPortfolio"),a=sessionStorage.getItem("memberId"),r=sessionStorage.getItem("usersName");$.ajax({url:`${e}/addComment`,type:"POST",data:{portfolioID:n,postByID:a,postByUsername:r,postDate:t,content:o},success:function(e){$("textarea#viewMorePage-postComment").val(""),function(e){let o=`\n    <div class="comment-container mb-3">\n    <div class="comment-info">\n    <strong class="mr-1">You</strong>\n    <p>on ${i(e.posted)}</p>\n    </div>\n    <p>${e.text}</p>\n    </div>\n    `;document.getElementById("viewMorePage-comments").innerHTML+=o}(e)},error:function(e){console.log(e)}})})});